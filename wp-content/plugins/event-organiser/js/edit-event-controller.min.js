var eventorganiser=eventorganiser||{};eventorganiser.versionCompare=function(a,d){if(typeof a+typeof d!="stringstring")return false;a=a.split(".");d=d.split(".");for(var b=0,f=Math.max(a.length,d.length);b<f;b++)if(a[b]&&!d[b]&&parseInt(a[b])>0||parseInt(a[b])>parseInt(d[b]))return 1;else if(d[b]&&!a[b]&&parseInt(d[b])>0||parseInt(a[b])<parseInt(d[b]))return-1;return 0};
jQuery(document).ready(function(a){var d;eventOrganiserSchedulePicker.init({views:{start_date:"#eventorganiser_detail #from_date",start_time:"#HWSEvent_time",end_date:"#eventorganiser_detail #to_date",end_time:"#HWSEvent_time2",occurrence_picker:"#eo_occurrence_datepicker",occurrence_picker_toggle:".eo_occurrence_toggle",schedule_last_date:"#recend",schedule:"#HWSEventInput_Req",is_all_day:"#eo_allday",frequency:"#HWSEvent_freq",week_repeat:"#dayofweekrepeat",month_repeat:"#dayofmonthrepeat",recurrence_section:".reocurrence_row",
include:"#eo_occurrence_includes",exclude:"#eo_occurrence_excludes",schedule_span:"#recpan",summary:"#event_summary"},format:EO_Ajax_Event.format,is24hour:Boolean(EO_Ajax_Event.is24hour),startday:EO_Ajax_Event.startday,schedule:window.eventOrganiserSchedule,locale:EO_Ajax_Event.locale,editable:a("#HWSEventInput_Req").val()=="once"||a("#HWSEventInput_Req").val()=="custom"});a("#HWSEvent_rec").click(function(){window.eventOrganiserSchedulePicker.options.editable=a("#HWSEvent_rec").is(":checked");window.eventOrganiserSchedulePicker.update_form()});
a.widget("ui.combobox",{_create:function(){var b=this.element.hide(),f=b.children(":selected");f=f.val()?f.text():"";b=a("<span>").addClass("ui-combobox eo-venue-input").insertAfter(b);var l={delay:0,minLength:0,source:function(e,c){a.getJSON(EO_Ajax_Event.ajaxurl+"?callback=?&action=eo-search-venue",e,function(g){g=a.map(g,function(h){h.label=h.name;return h});c(g)})},select:function(e,c){if(a("tr.venue_row").length>0){c.item.term_id==0?a("tr.venue_row").hide():a("tr.venue_row").show();a("#eventorganiser_event_detail tr.eo-add-new-venue").hide();
eo_initialize_map(c.item.venue_lat,c.item.venue_lng);a("#eo_venue_Lat").val(c.item.venue_lat);a("#eo_venue_Lng").val(c.item.venue_lng)}a("#venue_select").removeAttr("selected");a("#venue_select").val(c.item.term_id)}},i=a("<input>").appendTo(b).val(f).addClass("ui-combobox-input").autocomplete(l).addClass("ui-widget-content ui-corner-left"),j=a.ui?a.ui.version||0:-1,k=eventorganiser.versionCompare(j,"1.10")>=0?"ui-autocomplete":"autocomplete";i.data(k)._renderItem=function(e,c){if(c.term_id==0)return a("<li></li>").data(k+
"-item",c).append("<a>"+c.label+"</a>").appendTo(e);var g=a.grep([c.venue_address,c.venue_city,c.venue_state,c.venue_postcode,c.venue_country],function(m){return m}).join(", "),h=eventorganiser.versionCompare(j,"1.10")>=0?"ui-autocomplete-item":"item.autocomplete";return a("<li></li>").data(h,c).append("<a>"+c.label+"</br> <span style='font-size: 0.8em'><em>"+g+"</span></em></a>").appendTo(e)};f=a("<span>").addClass("eo-venue-combobox-buttons").appendTo(b);a("<a style='vertical-align: top;margin: 0px -1px;padding: 0px;height: 21px;'>").attr("title",
"Show All Items").appendTo(f).button({icons:{primary:"ui-icon-triangle-1-s"},text:false}).removeClass("ui-corner-all").addClass("ui-corner-right ui-combobox-toggle ui-combobox-button").click(function(){if(i.autocomplete("widget").is(":visible"))i.autocomplete("close");else{a(this).blur();i.autocomplete("search","").focus()}});"event"==pagenow&&EO_Ajax_Event.current_user_can.manage_venues&&a("<a style='vertical-align: top;margin: 0px -1px;padding: 0px;height: 21px;'>").attr("title","Create New Venue").appendTo(f).button({icons:{primary:"ui-icon-plus"},
text:false}).removeClass("ui-corner-all").addClass("ui-corner-right add-new-venue ui-combobox-button").click(function(){a("#eventorganiser_event_detail tr.eo-add-new-venue").show();a("tr.venue_row").show();d={id:a("#venue_select").val(),label:a(".eo-venue-input input").val(),lat:a("#eo_venue_Lat").val(),lng:a("#eo_venue_Lng").val()};a("#venue_select").removeAttr("selected").val(0);a(".eo-venue-combobox-select").hide();a(".eo-venue-input input").val("");eo_initialize_map(0,0);var e=EO_Ajax_Event.location;
if(e){e=e.split("/");e=e[e.length-1];eventorganiser_code_address(e)}else map.setZoom(1);a(this).blur()})}});a("#venue_select").combobox();a(".eo-add-new-venue-cancel").click(function(b){b.preventDefault();a(".eo-venue-combobox-select").show();a(".eo-add-new-venue input").val("");eo_initialize_map(d.lat,d.lng);a("#venue_select").val(d.id);a(".eo-venue-input input").val(d.label);a("#eventorganiser_event_detail tr.eo-add-new-venue").hide()})});
